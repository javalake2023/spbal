<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spbal">
<title>spbal - Spatially Balanced Sampling • spbal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="spbal - Spatially Balanced Sampling">
<meta property="og:description" content="spbal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spbal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/spbal.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>spbal - Spatially Balanced Sampling</h1>
                        <h4 data-toc-skip class="author">spbal
1.0.0</h4>
            
            <h4 data-toc-skip class="date">April 2024</h4>
      
      
      <div class="d-none name"><code>spbal.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">spbal</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="spbal">spbal<a class="anchor" aria-label="anchor" href="#spbal"></a>
</h2>
<p>This vignette is intended to provide details of the functions and
methods provided in the <strong>spbal</strong> package. The
<strong>spbal</strong> package has three spatially balanced sample
designs: BAS, Halton Frames and HIP. This document illustrates how
samples are drawn using <strong>spbal</strong>, including master and
stratified sampling applications. The package is freely available from
CRAN. This document was created with <strong>spbal</strong> version
<span class="math inline">\(1.0.0\)</span>.</p>
<p>This vignette is divided into the following sections:</p>
<ul>
<li>Simple Random Sampling (SRS)</li>
<li>Balanced acceptance sampling (BAS)</li>
<li>Halton Frames (HF)</li>
<li>Halton Iterative Partitioning (HIP)</li>
</ul>
<p>Lets start by looking at Simple Random Sampling (SRS).</p>
<div class="section level3">
<h3 id="simple-random-sampling-srs">Simple Random Sampling (SRS)<a class="anchor" aria-label="anchor" href="#simple-random-sampling-srs"></a>
</h3>
<p>Draw a random sample without replacement from a population.</p>
<div class="section level4">
<h4 id="spbalsrs">spbal::SRS()<a class="anchor" aria-label="anchor" href="#spbalsrs"></a>
</h4>
<p>This function invokes <strong>base::sample()</strong> to draw a
random sample using a user specified random seed. Returned is a list of
random positive integers of length <strong>sample_size</strong>, in the
range <span class="math inline">\(1\)</span> to
<strong>total_rows</strong>, these can then be used to index the
original population data.</p>
<p>The following parameters are supported:</p>
<ul>
<li>
<strong>seed</strong> - The random seed to be used to draw the
current sample. The default is <span class="math inline">\(42\)</span>.</li>
<li>
<strong>total_rows</strong> - The total number of rows in your
population.</li>
<li>
<strong>sample_size</strong> - The number of rows wanted in the
random sample.</li>
</ul>
<p>All parameter values must be numeric and have values greater than
zero, <strong>sample_size</strong> must be less than
<strong>total_rows</strong>.</p>
<div class="section level5">
<h5 id="spbalsrs-code-example">spbal::SRS() code example<a class="anchor" aria-label="anchor" href="#spbalsrs-code-example"></a>
</h5>
<p>Function <strong>spbal::SRS()</strong> returns a list of size
<strong>sample_size</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a random sample of 20 with a seed of 99 from a population of 100.</span></span>
<span><span class="va">rand_samp</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/SRS.html">SRS</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">99</span>, total_rows <span class="op">=</span> <span class="fl">100</span>, sample_size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">rand_samp</span></span>
<span><span class="co">#&gt;  [1] 48 33 44 22 62 32 13 20 31 68  9 82 88 30 86 84 95 14  4 78</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="balanced-acceptance-samples-bas">Balanced Acceptance Samples (BAS)<a class="anchor" aria-label="anchor" href="#balanced-acceptance-samples-bas"></a>
</h3>
<p>BAS draws spatially balanced samples from areal resources. To draw
BAS samples, <strong>spbal</strong> requires a study region shapefile
and the region’s bounding box. An initial sample size is also needed,
which can be easily increased or decreased within <strong>spbal</strong>
for master sampling applications.</p>
<div class="section level4">
<h4 id="spbalbas">spbal::BAS()<a class="anchor" aria-label="anchor" href="#spbalbas"></a>
</h4>
<p>The <strong>spbal::BAS()</strong> function supports the following
input parameters:</p>
<ul>
<li>
<strong>shapefile</strong> The shape file as a polygon (sp or sf) to
select sites for.</li>
<li>
<strong>n</strong> The number of sites to select. If using
stratification it is a named vector containing sample sizes of each
group.</li>
<li>
<strong>boundingbox</strong> The Bounding box around the study area.
If a bounding box is not supplied then <strong>spbal</strong> will
generate a bounding box for the shapefile.</li>
<li>
<strong>minRadius</strong> If specified, the minimum distance, in
meters, allowed between sample points. This is applied to the
<em>$sample</em> points. Points that meet the <strong>minRadius</strong>
criteria are returned in the <strong>minRadius</strong> output variable.
The default value for <strong>minRadius</strong>.</li>
<li>
<strong>panels</strong> A list of integers that define the size of
each panel in a non-overlapping panels design. The length of the list
determines the number of panels required. The sum of the integers in the
panels parameter will determine the total number of samples selected,
<strong>n</strong>. The default value for <strong>panels</strong> is
NULL, this indicates that a non-overlapping panel design is not
wanted.</li>
<li>
<strong>panel_overlap</strong> A list of integers that define the
overlap into the previous panel. Is only used when the
<strong>panels</strong> parameter is not NULL. The default value for
<strong>panel_overlap</strong> is NULL. The length of
<strong>panel_overlap</strong> must be equal to the length of panels.
The first value is always forced to zero as the first panel never
overlaps any region.</li>
<li>
<strong>stratum</strong> The name of a column in the data.frame
attached to <strong>shapefile</strong> that defines the strata of
interest.</li>
<li>
<strong>seeds</strong> A vector of two seeds, <strong>u1</strong>
and <strong>u2</strong>. If not specified, the default is NULL and will
be defined randomly.<br>
</li>
<li>
<strong>verbose</strong> A boolean, if you want to see any output
printed to screen set to TRUE. Helpful if taking a long time. The
default is FALSE i.e. no informational messages will be displayed.</li>
</ul>
<p>The <strong>spbal::BAS()</strong> function returns a list containing
three variables:</p>
<ul>
<li>
<strong>sample</strong> containing locations in the BAS sample, in
BAS order.</li>
<li>
<strong>seeds</strong> the <strong>u1</strong> and
<strong>u2</strong> seeds used to generate the sample.</li>
<li>
<strong>minRadius</strong> containing points from
<strong>sample</strong> that meet the <strong>minRadius</strong>
criteria. If the <strong>minRadius</strong> parameter is NULL then
<strong>minRadius</strong> will return NULL.</li>
</ul>
<p>The <em>sample</em> points are returned in the form of a simple
feature collection of POINT objects. They have the following
attributes:</p>
<ul>
<li>
<strong>SiteID</strong> A unique identifier for every sample point.
This encodes the BAS order.</li>
<li>
<strong>spbalSeqID</strong> A unique identifier for every sample
point. This encodes the BAS sample order.</li>
<li>
<strong>geometry</strong> The XY co-ordinates of the sample point in
the CRS of the original shapefile.</li>
</ul>
<div class="section level5">
<h5 id="spbalbas-code-examples">spbal::BAS() code examples<a class="anchor" aria-label="anchor" href="#spbalbas-code-examples"></a>
</h5>
<p>First, lets define our shapefile, select a region from within it and
define a bounding box around it:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the North Carolina shapefile supplied in the sf R package.</span></span>
<span><span class="va">shp_file</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shape/nc.shp"</span>, package<span class="op">=</span><span class="st">"sf"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `nc' from data source </span></span>
<span><span class="co">#&gt;   `/home/phil/R/x86_64-pc-linux-gnu-library/4.3/sf/shape/nc.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 100 features and 14 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shp_gates</span> <span class="op">&lt;-</span> <span class="va">shp_file</span><span class="op">[</span><span class="va">shp_file</span><span class="op">$</span><span class="va">NAME</span> <span class="op">==</span> <span class="st">"Gates"</span>,<span class="op">]</span></span>
<span><span class="va">shp_gates</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 14 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.95367 ymin: 36.29452 xmax: -76.46035 ymax: 36.55525</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt;    AREA PERIMETER CNTY_ CNTY_ID  NAME  FIPS FIPSNO CRESS_ID BIR74 SID74 NWBIR74</span></span>
<span><span class="co">#&gt; 8 0.091     1.284  1835    1835 Gates 37073  37073       37   420     0     254</span></span>
<span><span class="co">#&gt;   BIR79 SID79 NWBIR79                       geometry</span></span>
<span><span class="co">#&gt; 8   594     2     371 MULTIPOLYGON (((-76.56251 3...</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Vertically aligned master sample bounding box.</span></span>
<span><span class="va">bb</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/BoundingBox.html">BoundingBox</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_gates</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="equal-probability-bas-sample-">Equal probability BAS sample.<a class="anchor" aria-label="anchor" href="#equal-probability-bas-sample-"></a>
</h4>
<p>This section uses the Gates county loaded above. The first example
design is an equal probability BAS sample of <span class="math inline">\(n = 20\)</span> survey sites from Gates, North
Carolina, U.S.A. The call is below:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span></span>
<span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/BAS.html">BAS</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_gates</span>,</span>
<span>                     n <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>                     boundingbox <span class="op">=</span> <span class="va">bb</span><span class="op">)</span></span>
<span><span class="va">BAS20</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">sample</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BAS20</span></span>
<span><span class="co">#&gt; Simple feature collection with 20 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.93224 ymin: 36.30596 xmax: -76.51599 ymax: 36.54738</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    SiteID spbalSeqID                   geometry</span></span>
<span><span class="co">#&gt; 1       1          1 POINT (-76.88599 36.41219)</span></span>
<span><span class="co">#&gt; 2       2          2  POINT (-76.63932 36.4991)</span></span>
<span><span class="co">#&gt; 3       3          3 POINT (-76.76266 36.35425)</span></span>
<span><span class="co">#&gt; 4       4          4 POINT (-76.51599 36.44116)</span></span>
<span><span class="co">#&gt; 6       6          5 POINT (-76.67016 36.30596)</span></span>
<span><span class="co">#&gt; 7       7          6 POINT (-76.79349 36.39287)</span></span>
<span><span class="co">#&gt; 8       8          7 POINT (-76.54683 36.47979)</span></span>
<span><span class="co">#&gt; 10     10          8 POINT (-76.60849 36.42184)</span></span>
<span><span class="co">#&gt; 11     11          9 POINT (-76.73182 36.50876)</span></span>
<span><span class="co">#&gt; 13     13         10 POINT (-76.93224 36.45082)</span></span></code></pre></div>
<p>The site locations are illustrated below:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Plot using ggplot</span></span>
<span><span class="va">gates</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">shp_gates</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gates</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">BAS20</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">spbalSeqID</span>,</span>
<span>                vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>                geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span>,</span>
<span>            stat <span class="op">=</span> <span class="st">"sf_coordinates"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">BAS20</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Samples"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Define color scale and legend title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Spatially balanced sample using a equal probability BAS design."</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Total of 20 survey sites from Gates, North Carolina"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"spbal Equal probability BAS sample."</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span></code></pre></div>
<p><img src="spbal_files/figure-html/BASex1c-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="increase-the-bas-sample-size-">Increase the BAS sample size.<a class="anchor" aria-label="anchor" href="#increase-the-bas-sample-size-"></a>
</h4>
<p>To increase this BAS sample of <span class="math inline">\(20\)</span> sites to <span class="math inline">\(50\)</span> sites, we take the first <span class="math inline">\(50\)</span> points from the random-start Halton
sequence that BAS used to draw its sample. <strong>spbal</strong>
achieves this by specifying the random seed integers from the first
sample using the following call.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/BAS.html">BAS</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_gates</span>,</span>
<span>                      n <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>                      boundingbox <span class="op">=</span> <span class="va">bb</span>,</span>
<span>                      seeds <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">seed</span><span class="op">)</span></span>
<span><span class="va">BAS50</span> <span class="op">&lt;-</span> <span class="va">result2</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">BAS50</span></span>
<span><span class="co">#&gt; Simple feature collection with 50 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.93224 ymin: 36.30596 xmax: -76.49287 ymax: 36.5506</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    SiteID spbalSeqID                   geometry</span></span>
<span><span class="co">#&gt; 1       1          1 POINT (-76.88599 36.41219)</span></span>
<span><span class="co">#&gt; 2       2          2  POINT (-76.63932 36.4991)</span></span>
<span><span class="co">#&gt; 3       3          3 POINT (-76.76266 36.35425)</span></span>
<span><span class="co">#&gt; 4       4          4 POINT (-76.51599 36.44116)</span></span>
<span><span class="co">#&gt; 6       6          5 POINT (-76.67016 36.30596)</span></span>
<span><span class="co">#&gt; 7       7          6 POINT (-76.79349 36.39287)</span></span>
<span><span class="co">#&gt; 8       8          7 POINT (-76.54683 36.47979)</span></span>
<span><span class="co">#&gt; 10     10          8 POINT (-76.60849 36.42184)</span></span>
<span><span class="co">#&gt; 11     11          9 POINT (-76.73182 36.50876)</span></span>
<span><span class="co">#&gt; 13     13         10 POINT (-76.93224 36.45082)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check, first n_samples points in both samples must be the same.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">BAS20</span><span class="op">$</span><span class="va">geometry</span>, <span class="va">BAS50</span><span class="op">$</span><span class="va">geometry</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The first 20 sites in <strong>BAS50</strong> are identical to
<strong>BAS20</strong>. The sample size can be increased arbitrarily
from a specified seed, making BAS well-suited for master sampling
applications. The critical point is that any sub-sample of consecutive
points from a BAS master sample is a bona fide BAS sample. Users can
also specify their seed point using <strong>seeds = c(u1, u2)</strong>
to generate a specific random-start Halton sequence, such as
resurrecting a previously used BAS sample.</p>
<p>Plot the BAS point ordering, <strong>BAS20</strong> and
<strong>BAS50</strong> using ggplot.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Convert foreign object to an sf object for ggplot.</span></span>
<span><span class="va">gates</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">shp_gates</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gates</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">BAS50</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">BAS50</span><span class="op">$</span><span class="va">spbalSeqID</span>,</span>
<span>                vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.7</span>,</span>
<span>                geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"BAS Order"</span><span class="op">)</span>,</span>
<span>            stat <span class="op">=</span> <span class="st">"sf_coordinates"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">BAS50</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"BAS n = 20 + 30"</span><span class="op">)</span>,</span>
<span>                 stat <span class="op">=</span> <span class="st">"sf_coordinates"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">BAS20</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"BAS n = 20"</span><span class="op">)</span>,</span>
<span>                 stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"black"</span><span class="op">)</span>,</span>
<span>                    name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span>  </span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>      y <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"BAS samples from the Gates county."</span><span class="op">)</span></span></code></pre></div>
<p><img src="spbal_files/figure-html/BASex5a-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="stratified-bas-sample-">Stratified BAS Sample.<a class="anchor" aria-label="anchor" href="#stratified-bas-sample-"></a>
</h4>
<p>It is possible to create stratified samples from BAS master samples
using <strong>spbal</strong>. To implement this design, the input
shapefile must have labelled sub-regions or strata, all of which should
be enclosed within a single bounding box.</p>
<p>An example of a stratified design from a BAS master sample is shown
below. In this design, <span class="math inline">\(50\)</span> sites are
selected from three counties in the state of North Carolina, U.S.A, with
<span class="math inline">\(20\)</span> sites from Gates, <span class="math inline">\(20\)</span> from Northampton, and <span class="math inline">\(10\)</span> from Hertford. The code for this
stratified design is provided below, and the survey sites within each
stratum can be seen in the figure below.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gates"</span>, <span class="st">"Northampton"</span>, <span class="st">"Hertford"</span><span class="op">)</span></span>
<span><span class="va">n_strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gates"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="st">"Northampton"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="st">"Hertford"</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">shp_subset</span> <span class="op">&lt;-</span> <span class="va">shp_file</span><span class="op">[</span><span class="va">shp_file</span><span class="op">[[</span><span class="st">"NAME"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">strata</span>,<span class="op">]</span></span></code></pre></div>
<p>Define the bounding box for Gates, Northampton and Hertford using
<strong>spbal</strong>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bb_strata</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/BoundingBox.html">BoundingBox</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_subset</span><span class="op">)</span></span></code></pre></div>
<p>Draw the stratified sample from the BAS master sample and display the
first three sites in the Gates region.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span></span>
<span><span class="va">result3</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/BAS.html">BAS</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_subset</span>,</span>
<span>                      n <span class="op">=</span> <span class="va">n_strata</span>,</span>
<span>                      boundingbox <span class="op">=</span> <span class="va">bb_strata</span>,</span>
<span>                      stratum <span class="op">=</span> <span class="st">"NAME"</span><span class="op">)</span></span>
<span><span class="va">BASMaster</span> <span class="op">&lt;-</span> <span class="va">result3</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">gates_samp</span> <span class="op">&lt;-</span> <span class="va">BASMaster</span><span class="op">[</span><span class="va">BASMaster</span><span class="op">[[</span><span class="st">"NAME"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Gates"</span>,<span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gates_samp</span> </span>
<span><span class="co">#&gt; Simple feature collection with 20 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.92399 ymin: 36.33299 xmax: -76.49623 ymax: 36.54675</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    SiteID spbalSeqID  NAME                   geometry</span></span>
<span><span class="co">#&gt; 1       1          1 Gates  POINT (-76.53563 36.5266)</span></span>
<span><span class="co">#&gt; 5       9          2 Gates    POINT (-76.58066 36.41)</span></span>
<span><span class="co">#&gt; 7      13          3 Gates  POINT (-76.67071 36.4683)</span></span>
<span><span class="co">#&gt; 8      15          4 Gates POINT (-76.85082 36.38085)</span></span>
<span><span class="co">#&gt; 13     25          5 Gates POINT (-76.60317 36.46902)</span></span>
<span><span class="co">#&gt; 16     31          6 Gates POINT (-76.87333 36.43987)</span></span>
<span><span class="co">#&gt; 19     37          7 Gates POINT (-76.73825 36.52732)</span></span>
<span><span class="co">#&gt; 23     45          8 Gates  POINT (-76.6482 36.41072)</span></span>
<span><span class="co">#&gt; 31     61          9 Gates POINT (-76.72136 36.48845)</span></span>
<span><span class="co">#&gt; 32     63         10 Gates   POINT (-76.90147 36.401)</span></span></code></pre></div>
<p>Plot the stratified sample using ggplot.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strat</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">shp_subset</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gates_samp</span>       <span class="op">&lt;-</span> <span class="va">BASMaster</span><span class="op">[</span><span class="va">BASMaster</span><span class="op">[[</span><span class="st">"NAME"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Gates"</span>,<span class="op">]</span></span>
<span><span class="va">northampton_samp</span> <span class="op">&lt;-</span> <span class="va">BASMaster</span><span class="op">[</span><span class="va">BASMaster</span><span class="op">[[</span><span class="st">"NAME"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Northampton"</span>,<span class="op">]</span></span>
<span><span class="va">hertford_samp</span>    <span class="op">&lt;-</span> <span class="va">BASMaster</span><span class="op">[</span><span class="va">BASMaster</span><span class="op">[[</span><span class="st">"NAME"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Hertford"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">strat</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gates_samp</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Gates"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">northampton_samp</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Northampton"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hertford_samp</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Hertford"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Define color scale and legend title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Stratified samples from BAS master samples."</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"50 sites from North Carolina, U.S.A, 20 from Gates, \n20 from Northampton and 10 from Hertford."</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"spbal Stratified BAS sample."</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span></code></pre></div>
<p><img src="spbal_files/figure-html/BASex10a-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="increasing-or-decreasing-strata-sample-sizes-">Increasing or decreasing strata sample sizes.<a class="anchor" aria-label="anchor" href="#increasing-or-decreasing-strata-sample-sizes-"></a>
</h4>
<p>The stratum sample sizes can be easily increased or decreased using
points from the master sample. For instance, one may double the number
of survey sites in the Hertford stratum (from <span class="math inline">\(10\)</span> to <span class="math inline">\(20\)</span>) for the stratified design above using
the <strong>seeds</strong> input. The call is below.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gates"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="st">"Northampton"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="st">"Hertford"</span> <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">result4</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/BAS.html">BAS</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_subset</span>,</span>
<span>                      n <span class="op">=</span> <span class="va">n_strata</span>,</span>
<span>                      boundingbox <span class="op">=</span> <span class="va">bb_strata</span>,</span>
<span>                      seeds <span class="op">=</span> <span class="va">result3</span><span class="op">$</span><span class="va">seed</span>,</span>
<span>                      stratum <span class="op">=</span> <span class="st">"NAME"</span><span class="op">)</span></span>
<span><span class="va">BASMaster</span> <span class="op">&lt;-</span> <span class="va">result4</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">gates_samp2</span> <span class="op">&lt;-</span> <span class="va">BASMaster</span><span class="op">[</span><span class="va">BASMaster</span><span class="op">[[</span><span class="st">"NAME"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Gates"</span>,<span class="op">]</span></span>
<span><span class="va">gates_samp2</span></span>
<span><span class="co">#&gt; Simple feature collection with 20 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.92399 ymin: 36.33299 xmax: -76.49623 ymax: 36.54675</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    SiteID spbalSeqID  NAME                   geometry</span></span>
<span><span class="co">#&gt; 1       1          1 Gates  POINT (-76.53563 36.5266)</span></span>
<span><span class="co">#&gt; 5       9          2 Gates    POINT (-76.58066 36.41)</span></span>
<span><span class="co">#&gt; 7      13          3 Gates  POINT (-76.67071 36.4683)</span></span>
<span><span class="co">#&gt; 8      15          4 Gates POINT (-76.85082 36.38085)</span></span>
<span><span class="co">#&gt; 13     25          5 Gates POINT (-76.60317 36.46902)</span></span>
<span><span class="co">#&gt; 16     31          6 Gates POINT (-76.87333 36.43987)</span></span>
<span><span class="co">#&gt; 19     37          7 Gates POINT (-76.73825 36.52732)</span></span>
<span><span class="co">#&gt; 23     45          8 Gates  POINT (-76.6482 36.41072)</span></span>
<span><span class="co">#&gt; 31     61          9 Gates POINT (-76.72136 36.48845)</span></span>
<span><span class="co">#&gt; 32     63         10 Gates   POINT (-76.90147 36.401)</span></span></code></pre></div>
<p>The <span class="math inline">\(20\)</span> sites in
<strong>gates_samp2</strong> are identical to
<strong>gates_samp</strong> because the same seed point was used.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ensure gates_samp is equal to the first 10 sites in gates_samp2. Must return TRUE.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">gates_samp</span><span class="op">$</span><span class="va">geometry</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, <span class="va">gates_samp2</span><span class="op">$</span><span class="va">geometry</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Plot the increased stratified sample using ggplot.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gates_samp4</span>       <span class="op">&lt;-</span> <span class="va">BASMaster</span><span class="op">[</span><span class="va">BASMaster</span><span class="op">[[</span><span class="st">"NAME"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Gates"</span>,<span class="op">]</span></span>
<span><span class="va">northampton_samp4</span> <span class="op">&lt;-</span> <span class="va">BASMaster</span><span class="op">[</span><span class="va">BASMaster</span><span class="op">[[</span><span class="st">"NAME"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Northampton"</span>,<span class="op">]</span></span>
<span><span class="va">hertford_samp4</span>    <span class="op">&lt;-</span> <span class="va">BASMaster</span><span class="op">[</span><span class="va">BASMaster</span><span class="op">[[</span><span class="st">"NAME"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Hertford"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">strat</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gates_samp4</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Gates"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">northampton_samp4</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Northampton"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hertford_samp4</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Hertford"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Define color scale and legend title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Stratified samples from BAS master samples."</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"60 sites from North Carolina, U.S.A, 20 from Gates, \n20 from Northampton and 20 from Hertford."</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"spbal Stratified BAS samples."</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span></code></pre></div>
<p><img src="spbal_files/figure-html/BASex13a-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="non-overlapping-panel-design-">Non-Overlapping panel design.<a class="anchor" aria-label="anchor" href="#non-overlapping-panel-design-"></a>
</h4>
<p>The final BAS example design with <strong>spbal</strong> is a
non-overlapping panel design for surveying over time. This design has
three panels containing <span class="math inline">\(20\)</span> survey
sites from the county of Gates, North Carolina, U.S.A. Each panel is a
spatially balanced sample of size <span class="math inline">\(n =
20\)</span>, and the collection of sites from all panels is a spatially
balanced sample of size <span class="math inline">\(n = 60\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n_panels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">result5</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/BAS.html">BAS</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_gates</span>,</span>
<span>                      panels <span class="op">=</span> <span class="va">n_panels</span>,</span>
<span>                      boundingbox <span class="op">=</span> <span class="va">bb</span><span class="op">)</span></span>
<span><span class="va">BASpanel</span> <span class="op">&lt;-</span> <span class="va">result5</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">BASpanel</span></span>
<span><span class="co">#&gt; Simple feature collection with 60 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.93224 ymin: 36.29738 xmax: -76.49287 ymax: 36.5506</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    SiteID spbalSeqID                   geometry panel_id</span></span>
<span><span class="co">#&gt; 1       1          1 POINT (-76.88599 36.41219)        1</span></span>
<span><span class="co">#&gt; 2       2          2  POINT (-76.63932 36.4991)        1</span></span>
<span><span class="co">#&gt; 3       3          3 POINT (-76.76266 36.35425)        1</span></span>
<span><span class="co">#&gt; 4       4          4 POINT (-76.51599 36.44116)        1</span></span>
<span><span class="co">#&gt; 6       6          5 POINT (-76.67016 36.30596)        1</span></span>
<span><span class="co">#&gt; 7       7          6 POINT (-76.79349 36.39287)        1</span></span>
<span><span class="co">#&gt; 8       8          7 POINT (-76.54683 36.47979)        1</span></span>
<span><span class="co">#&gt; 10     10          8 POINT (-76.60849 36.42184)        1</span></span>
<span><span class="co">#&gt; 11     11          9 POINT (-76.73182 36.50876)        1</span></span>
<span><span class="co">#&gt; 13     13         10 POINT (-76.93224 36.45082)        1</span></span></code></pre></div>
<p>The sites in panel <span class="math inline">\(2\)</span> are
obtained using the <strong>getPanel()</strong> function as follows.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">panel_2</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/getPanel.html">getPanel</a></span><span class="op">(</span><span class="va">BASpanel</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">panel_2</span> <span class="op">&lt;-</span> <span class="va">panel_2</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">panel_2</span></span>
<span><span class="co">#&gt; Simple feature collection with 20 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.90911 ymin: 36.31884 xmax: -76.49287 ymax: 36.5506</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    SiteID spbalSeqID                   geometry panel_id</span></span>
<span><span class="co">#&gt; 30     30         21 POINT (-76.69328 36.35747)        2</span></span>
<span><span class="co">#&gt; 31     31         22 POINT (-76.81661 36.44438)        2</span></span>
<span><span class="co">#&gt; 32     32         23 POINT (-76.56995 36.53129)        2</span></span>
<span><span class="co">#&gt; 34     34         24 POINT (-76.63162 36.39609)        2</span></span>
<span><span class="co">#&gt; 35     35         25   POINT (-76.75495 36.483)        2</span></span>
<span><span class="co">#&gt; 37     37         26 POINT (-76.90911 36.42506)        2</span></span>
<span><span class="co">#&gt; 38     38         27 POINT (-76.66245 36.51198)        2</span></span>
<span><span class="co">#&gt; 39     39         28 POINT (-76.78578 36.36712)        2</span></span>
<span><span class="co">#&gt; 40     40         29 POINT (-76.53912 36.45403)        2</span></span>
<span><span class="co">#&gt; 41     41         30 POINT (-76.84745 36.54095)        2</span></span></code></pre></div>
<p>Plot the sample sites in each panel using ggplot.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to extract the sample points associated with a specific panelid, we can use the following code:</span></span>
<span><span class="va">panel_1</span> <span class="op">&lt;-</span> <span class="va">BASpanel</span><span class="op">[</span><span class="va">BASpanel</span><span class="op">$</span><span class="va">panel_id</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">panel_2</span> <span class="op">&lt;-</span> <span class="va">BASpanel</span><span class="op">[</span><span class="va">BASpanel</span><span class="op">$</span><span class="va">panel_id</span> <span class="op">==</span> <span class="fl">2</span>,<span class="op">]</span></span>
<span><span class="va">panel_3</span> <span class="op">&lt;-</span> <span class="va">BASpanel</span><span class="op">[</span><span class="va">BASpanel</span><span class="op">$</span><span class="va">panel_id</span> <span class="op">==</span> <span class="fl">3</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># or use the spbal::getPanel() function.</span></span>
<span><span class="co">#panel_1 &lt;- spbal::getPanel(BASpanel, 1)</span></span>
<span><span class="co">#panel_2 &lt;- spbal::getPanel(BASpanel, 2)</span></span>
<span><span class="co">#panel_3 &lt;- spbal::getPanel(BASpanel, 3)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gates</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">panel_1</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Panel-1 (n = 20)"</span><span class="op">)</span>,</span>
<span>                 stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">panel_2</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Panel-2 (n = 20)"</span><span class="op">)</span>,</span>
<span>                 stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">panel_3</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Panel-3 (n = 20)"</span><span class="op">)</span>,</span>
<span>                 stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"black"</span><span class="op">)</span>,</span>
<span>                                     name <span class="op">=</span> <span class="st">"Panels"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Panel Design from BAS Master Sample"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Total of 60 survey sites from Gates, North Carolina, U.S.A"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"spbal Non-overlapping Panel Design."</span><span class="op">)</span></span></code></pre></div>
<p><img src="spbal_files/figure-html/BASex16a-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="overlapping-panel-design-">Overlapping panel design.<a class="anchor" aria-label="anchor" href="#overlapping-panel-design-"></a>
</h4>
<p>Panel overlaps are also possible in <strong>spbal</strong>. The
following call sets the last five elements from panel <span class="math inline">\(1\)</span> as the first five elements in panel
<span class="math inline">\(2\)</span> and the last five elements from
panel <span class="math inline">\(2\)</span> as the first five elements
in panel <span class="math inline">\(3\)</span> (<span class="math inline">\(50\)</span> unique sites). Because the overlaps
are sub-samples of consecutive BAS points, they are well-spread over the
study region. Furthermore, each panel is a spatially balanced sample of
size <span class="math inline">\(n = 20\)</span>, and the collection of
sites from all panels is a spatially balanced sample of size <span class="math inline">\(n = 50\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span></span>
<span><span class="va">n_panels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">n_panel_overlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">result6</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/BAS.html">BAS</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_gates</span>,</span>
<span>                      panels <span class="op">=</span> <span class="va">n_panels</span>,</span>
<span>                      panel_overlap <span class="op">=</span> <span class="va">n_panel_overlap</span>,</span>
<span>                      boundingbox <span class="op">=</span> <span class="va">bb</span><span class="op">)</span></span>
<span><span class="va">BASpanel</span> <span class="op">&lt;-</span> <span class="va">result6</span><span class="op">$</span><span class="va">sample</span></span></code></pre></div>
<p>The sites in panel <span class="math inline">\(2\)</span> are
obtained using the <strong>getPanel()</strong> function as follows. The
first five sites in panel <span class="math inline">\(2\)</span> are
also in panel <span class="math inline">\(1\)</span> so
<strong>panel_id</strong> = <span class="math inline">\(1, 2\)</span>
for these sites.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">panel_2</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/getPanel.html">getPanel</a></span><span class="op">(</span><span class="va">BASpanel</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">panel_2</span> <span class="op">&lt;-</span> <span class="va">panel_2</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">panel_2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span>
<span><span class="co">#&gt; Simple feature collection with 5 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.83974 ymin: 36.3285 xmax: -76.59308 ymax: 36.54738</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt;    SiteID spbalSeqID                   geometry panel_id</span></span>
<span><span class="co">#&gt; 22     22         16 POINT (-76.65474 36.46047)     1, 2</span></span>
<span><span class="co">#&gt; 23     23         17 POINT (-76.77807 36.54738)     1, 2</span></span>
<span><span class="co">#&gt; 25     25         18 POINT (-76.83974 36.38644)     1, 2</span></span>
<span><span class="co">#&gt; 26     26         19 POINT (-76.59308 36.47335)     1, 2</span></span>
<span><span class="co">#&gt; 27     27         20  POINT (-76.71641 36.3285)     1, 2</span></span></code></pre></div>
<p>Plot our overlapped samples.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">panel_1</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/getPanel.html">getPanel</a></span><span class="op">(</span><span class="va">BASpanel</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">panel_2</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/getPanel.html">getPanel</a></span><span class="op">(</span><span class="va">BASpanel</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">panel_3</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/getPanel.html">getPanel</a></span><span class="op">(</span><span class="va">BASpanel</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gates</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_jitter.html" class="external-link">st_jitter</a></span><span class="op">(</span><span class="va">panel_1</span><span class="op">$</span><span class="va">sample</span>, <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Panel-1"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_jitter.html" class="external-link">st_jitter</a></span><span class="op">(</span><span class="va">panel_2</span><span class="op">$</span><span class="va">sample</span>, <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Panel-2"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">panel_3</span><span class="op">$</span><span class="va">sample</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Panel-3"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Overlapped Panels"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Define color scale and legend title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Spatially balanced sample using a overlapping panel \ndesign, of three panels, each containing 20 survey sites."</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Total of 50 survey sites from Gates, North Carolina. Panel Overlap = (0, 5, 5)"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"spbal Overlapping Panel Design."</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span></code></pre></div>
<p><img src="spbal_files/figure-html/BASex19a-1.png" width="768"></p>
</div>
</div>
<div class="section level3">
<h3 id="halton-frame-hf">Halton Frame (HF)<a class="anchor" aria-label="anchor" href="#halton-frame-hf"></a>
</h3>
<p>Halton Frames discretize an areal resource into a spatially ordered
grid, where samples of consecutive frame points are spatially
balanced.</p>
<div class="section level4">
<h4 id="spbalhaltonframe">spbal::HaltonFrame()<a class="anchor" aria-label="anchor" href="#spbalhaltonframe"></a>
</h4>
<p>The <strong>spbal::HaltonFrame()</strong> function supports the
following input parameters:</p>
<ul>
<li>
<strong>shapefile</strong> The shape file as a polygon (sp or sf) to
select sites for.</li>
<li>
<strong>N</strong> The number of points in the frame to
generate.</li>
<li>
<strong>J</strong> The number of grid cells. A list of <span class="math inline">\(2\)</span> values. The default value is <span class="math inline">\(c(3, 2)\)</span>.</li>
<li>
<strong>bases</strong> Co-prime base for the Halton Sequence. The
default value is <span class="math inline">\(c(2, 3)\)</span>.</li>
<li>
<strong>boundingbox</strong> The bounding box around the study area.
If a bounding box is not supplied then <strong>spbal</strong> will
generate a bounding box for the shapefile.</li>
<li>
<strong>panels</strong> A list of integers that define the size of
each panel in a non-overlapping panels design. The length of the list
determines the number of panels required. The sum of the integers in the
panels parameter will determine the total number of samples selected,
<strong>n</strong>. The default value for <strong>panels</strong> is
NULL, this indicates that a non-overlapping panel design is not
wanted.</li>
<li>
<strong>panel_overlap</strong> A list of integers that define the
overlap into the previous panel. Is only used when the
<strong>panels</strong> parameter is not NULL. The default value for
<strong>panel_overlap</strong> is NULL. The length of
<strong>panel_overlap</strong> must be equal to the length of panels.
The first value is always forced to zero as the first panel never
overlaps any region.</li>
<li>
<strong>stratum</strong> The name of a feature column in the
<strong>shapefile</strong> that defines the strata of interest. The
default value is NULL indicating that stratification will not be
performed.</li>
<li>
<strong>seeds</strong> A vector of two seeds, <strong>u1</strong>
and <strong>u2</strong>. If not specified, the default is NULL and will
be defined randomly.</li>
<li>
<strong>verbose</strong> A boolean, if you want to see any output
printed to screen set to TRUE. Helpful if taking a long time. The
default is FALSE i.e. no informational messages will be displayed.</li>
</ul>
<p>The <strong>HaltonFrame()</strong> function returns a list containing
five variables:</p>
<ul>
<li>
<strong>J</strong> The number of grid cells. A list of <span class="math inline">\(2\)</span> values that were used to generate this
Halton grid and frame.</li>
<li>
<strong>hg.pts.shp</strong> Halton grid over the bounding box and
study area.</li>
<li>
<strong>hf.pts.shp</strong> Halton frame, the sample points within
the study area.</li>
<li>
<strong>bb</strong> The bounding box surrounding the study
area.</li>
<li>
<strong>seeds</strong> The <span class="math inline">\(u1\)</span>
and <span class="math inline">\(u2\)</span> seeds used to generate the
sample.</li>
</ul>
<p>The sample points in <em>hf.pts.shp</em> are returned in the form of
a simple feature collection of POINT objects. It has the following
features:</p>
<ul>
<li>
<strong>ID</strong> A unique identifier, the Halton frame point
order.</li>
<li>
<strong>spbalSeqID</strong> A unique identifier, the study area
point order.</li>
<li>
<strong>x</strong> The point geometry.</li>
</ul>
</div>
<div class="section level4">
<h4 id="spbalhaltonframe-code-example">spbal::HaltonFrame() code example<a class="anchor" aria-label="anchor" href="#spbalhaltonframe-code-example"></a>
</h4>
<p>To generate Halton Frames, <strong>spbal</strong> requires a study
region shapefile and the region’s bounding box. To illustrate Halton
Frames, we discretize the Gates study region into a coarse grid using
<span class="math inline">\(B = 2^{J_1} \times 3^{J_2} = 2^3 \times
3^2\)</span> (a <span class="math inline">\(9\)</span> by <span class="math inline">\(8\)</span> grid). The call is below.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span></span>
<span><span class="va">result6</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/HaltonFrame.html">HaltonFrame</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_gates</span>, </span>
<span>                              J <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                              boundingbox <span class="op">=</span> <span class="va">bb</span><span class="op">)</span></span>
<span><span class="va">Frame</span> <span class="op">&lt;-</span> <span class="va">result6</span><span class="op">$</span><span class="va">hf.pts.shp</span></span>
<span><span class="va">Grid</span> <span class="op">&lt;-</span> <span class="va">result6</span><span class="op">$</span><span class="va">hg.pts.shp</span></span></code></pre></div>
<p>Spatially ordered <span class="math inline">\(9\)</span> by <span class="math inline">\(8\)</span> Halton grid <span class="math inline">\((B = 2^{3} * 3^{2} = 72)\)</span> for the Gates
county in North Carolina, U.S.A.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Grid - Halton grid over Gates county.</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gates</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Grid</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ID</span>,</span>
<span>                vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>                geometry <span class="op">=</span> <span class="va">x</span>,</span>
<span>                x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span>,</span>
<span>            stat <span class="op">=</span> <span class="st">"sf_coordinates"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Grid</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">x</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Samples"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Define color scale and legend title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"A Halton grid, B = 2^3 * 3^2, over Gates, North Carolina, U.S.A."</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"A total of 432 points."</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"spbal Halton Grid example."</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span></code></pre></div>
<p><img src="spbal_files/figure-html/HFex1b-1.png" width="768"></p>
<p>and the corresponding Halton Frame for the Gates county in North
Carolina in the U.S.A.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Frame - Halton frame over Gates county.</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gates</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Frame</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">ID</span>,</span>
<span>                vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>                geometry <span class="op">=</span> <span class="va">x</span>,</span>
<span>                x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span>,</span>
<span>            stat <span class="op">=</span> <span class="st">"sf_coordinates"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Frame</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">x</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Samples"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Define color scale and legend title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"A Halton frame, B = 2^3 * 3^2, over Gates, North Carolina, U.S.A."</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Showing sample points within the Gates shapefile."</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"spbal Halton Frame example."</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span></code></pre></div>
<p><img src="spbal_files/figure-html/HFex1c-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="halton-frame-fine-grid">Halton frame fine grid<a class="anchor" aria-label="anchor" href="#halton-frame-fine-grid"></a>
</h4>
<p>The second example frame generates a fine grid using an approximately
regular <span class="math inline">\(B = 2^8 \times 3^5 = 256 \times
243\)</span> Halton Frame over Gates and draws a spatially balanced
sample of <span class="math inline">\(n = 25\)</span>. The call is
below.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span></span>
<span><span class="va">result7</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/HaltonFrame.html">HaltonFrame</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_gates</span>,</span>
<span>                              J <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                              boundingbox <span class="op">=</span> <span class="va">bb</span><span class="op">)</span></span>
<span><span class="va">Frame</span> <span class="op">&lt;-</span> <span class="va">result7</span><span class="op">$</span><span class="va">hf.pts.shp</span></span></code></pre></div>
<p>Draw <span class="math inline">\(n = 25\)</span> sites from the
Halton Frame using the <strong>getSample()</strong> function.</p>
<p>The first 25 sites from a <span class="math inline">\(B = 2^{8} *
3^{5}\)</span> Halton Frame (<span class="math inline">\(62,208\)</span>
grid points covering Gates), the numbering shows the frame’s ordering,
where sub-samples of consecutively numbered points are spatially
balanced samples.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">FrameSample</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/getSample.html">getSample</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">Frame</span>, </span>
<span>                        n <span class="op">=</span> <span class="va">n_samples</span><span class="op">)</span></span>
<span><span class="va">FrameSample</span> <span class="op">&lt;-</span> <span class="va">FrameSample</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">FrameSample</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"spbalSeqID"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; Simple feature collection with 10 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.86985 ymin: 36.33583 xmax: -76.53069 ymax: 36.55364</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt;                             x spbalSeqID</span></span>
<span><span class="co">#&gt; 1  POINT (-76.80818 36.37982)          1</span></span>
<span><span class="co">#&gt; 2  POINT (-76.56152 36.46673)          2</span></span>
<span><span class="co">#&gt; 3  POINT (-76.86985 36.55364)          3</span></span>
<span><span class="co">#&gt; 5  POINT (-76.74652 36.38411)          4</span></span>
<span><span class="co">#&gt; 8  POINT (-76.65402 36.41308)          5</span></span>
<span><span class="co">#&gt; 9  POINT (-76.77735 36.49999)          6</span></span>
<span><span class="co">#&gt; 10 POINT (-76.53069 36.35514)          7</span></span>
<span><span class="co">#&gt; 11 POINT (-76.83901 36.44205)          8</span></span>
<span><span class="co">#&gt; 12 POINT (-76.59235 36.52896)          9</span></span>
<span><span class="co">#&gt; 16 POINT (-76.69256 36.33583)         10</span></span></code></pre></div>
<p>Plot the sample and number the points in the frame’s order (given by
<strong>spbalSeqID</strong>) using ggplot.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gates</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">FrameSample</span>, </span>
<span>            size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">spbalSeqID</span>,</span>
<span>                vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>,</span>
<span>                geometry <span class="op">=</span> <span class="va">x</span>,</span>
<span>                x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"Frame Order"</span><span class="op">)</span>,</span>
<span>                stat <span class="op">=</span> <span class="st">"sf_coordinates"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">FrameSample</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">x</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Samples"</span><span class="op">)</span>,</span>
<span>                 stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Define color scale and legend title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"First 25 sites from the Gates Halton Frame."</span><span class="op">)</span></span></code></pre></div>
<p><img src="spbal_files/figure-html/HFex1f-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="spatially-balanced-sample-from-a-random-position">Spatially balanced sample from a random position<a class="anchor" aria-label="anchor" href="#spatially-balanced-sample-from-a-random-position"></a>
</h4>
<p>It is also possible to draw a spatially balanced sample from a random
position in the frame using the <strong>getSample()</strong> function.
The call for an <span class="math inline">\(n = 20\)</span> sample is
given below. Note the use of the <strong>randomStart = TRUE</strong>
parameter to generate the sample from a random position.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">FrameSample</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/getSample.html">getSample</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">Frame</span>, </span>
<span>                        n <span class="op">=</span> <span class="va">n_samples</span>, </span>
<span>                        randomStart <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">FrameSample</span> <span class="op">&lt;-</span> <span class="va">FrameSample</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">FrameSample</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"spbalSeqID"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; Simple feature collection with 10 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.86214 ymin: 36.32188 xmax: -76.52298 ymax: 36.55364</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt;                                 x spbalSeqID</span></span>
<span><span class="co">#&gt; 519961 POINT (-76.60006 36.54399)      36721</span></span>
<span><span class="co">#&gt; 519971 POINT (-76.72339 36.32188)      36722</span></span>
<span><span class="co">#&gt; 520001 POINT (-76.67714 36.35085)      36723</span></span>
<span><span class="co">#&gt; 520011 POINT (-76.80047 36.43776)      36724</span></span>
<span><span class="co">#&gt; 520021 POINT (-76.55381 36.52467)      36725</span></span>
<span><span class="co">#&gt; 520031 POINT (-76.86214 36.37982)      36726</span></span>
<span><span class="co">#&gt; 520041 POINT (-76.61548 36.46673)      36727</span></span>
<span><span class="co">#&gt; 520051 POINT (-76.73881 36.55364)      36728</span></span>
<span><span class="co">#&gt; 520081 POINT (-76.64631 36.47102)      36729</span></span>
<span><span class="co">#&gt; 520101 POINT (-76.52298 36.41308)      36730</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="halton-frame-overlapping-panel-design-">Halton frame overlapping panel design.<a class="anchor" aria-label="anchor" href="#halton-frame-overlapping-panel-design-"></a>
</h4>
<p>The following example generates an overlapping panel design for
surveying over time with three panels, each with <span class="math inline">\(20\)</span> sites with a panel overlap of
five.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Three panels, of 20 samples each.</span></span>
<span><span class="va">panels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># second panel overlaps first panel by 5, and third panel </span></span>
<span><span class="co"># overlaps second panel by 5.</span></span>
<span><span class="va">panel_overlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate the sample.</span></span>
<span><span class="va">samp</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/HaltonFrame.html">HaltonFrame</a></span><span class="op">(</span>J <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                           boundingbox <span class="op">=</span> <span class="va">bb</span>,</span>
<span>                           panels <span class="op">=</span> <span class="va">panels</span>,</span>
<span>                           panel_overlap <span class="op">=</span> <span class="va">panel_overlap</span>,</span>
<span>                           shapefile <span class="op">=</span> <span class="va">shp_gates</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get halton frame data from our sample.</span></span>
<span><span class="va">samp3</span> <span class="op">&lt;-</span> <span class="va">samp</span><span class="op">$</span><span class="va">hf.pts.shp</span></span>
<span><span class="va">samp3</span></span>
<span><span class="co">#&gt; Simple feature collection with 309 features and 3 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.93826 ymin: 36.29935 xmax: -76.47577 ymax: 36.55042</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    ID spbalSeqID                          x panel_id</span></span>
<span><span class="co">#&gt; 1   1          1 POINT (-76.62993 36.50214)        1</span></span>
<span><span class="co">#&gt; 2   2          2 POINT (-76.75326 36.35729)        1</span></span>
<span><span class="co">#&gt; 3   3          3   POINT (-76.5066 36.4442)        1</span></span>
<span><span class="co">#&gt; 4   4          4 POINT (-76.90743 36.53111)        1</span></span>
<span><span class="co">#&gt; 5   5          5   POINT (-76.66076 36.309)        1</span></span>
<span><span class="co">#&gt; 6   6          6 POINT (-76.78409 36.39591)        1</span></span>
<span><span class="co">#&gt; 7   7          7 POINT (-76.53743 36.48283)        1</span></span>
<span><span class="co">#&gt; 9   9          8  POINT (-76.5991 36.42488)        1</span></span>
<span><span class="co">#&gt; 10 10          9  POINT (-76.72243 36.5118)        1</span></span>
<span><span class="co">#&gt; 12 12         10 POINT (-76.93826 36.45386)        1</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">panelid</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">olPanel_1</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/getPanel.html">getPanel</a></span><span class="op">(</span><span class="va">samp3</span>, <span class="va">panelid</span><span class="op">)</span></span>
<span></span>
<span><span class="va">panelid</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">olPanel_2</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/getPanel.html">getPanel</a></span><span class="op">(</span><span class="va">samp3</span>, <span class="va">panelid</span><span class="op">)</span></span>
<span></span>
<span><span class="va">panelid</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">olPanel_3</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/getPanel.html">getPanel</a></span><span class="op">(</span><span class="va">samp3</span>, <span class="va">panelid</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot using ggplot2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gates</span>, size <span class="op">=</span> <span class="fl">4</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">10</span>, height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_jitter.html" class="external-link">st_jitter</a></span><span class="op">(</span><span class="va">olPanel_1</span><span class="op">$</span><span class="va">sample</span>, <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">x</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Panel-1"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_jitter.html" class="external-link">st_jitter</a></span><span class="op">(</span><span class="va">olPanel_2</span><span class="op">$</span><span class="va">sample</span>, <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">x</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Panel-2"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">olPanel_3</span><span class="op">$</span><span class="va">sample</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">x</span>,</span>
<span>                 x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, colour<span class="op">=</span> <span class="st">"Panel-3"</span><span class="op">)</span>,</span>
<span>             stat <span class="op">=</span> <span class="st">"sf_coordinates"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,</span>
<span>                                <span class="st">"blue"</span>,</span>
<span>                                <span class="st">"green"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Overlapped Panels"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Define color scale and legend title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Halton Frame sample using a overlapping panel \ndesign, of three panels, each containing 20 survey sites."</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Total of 50 survey sites from Gates, North Carolina, U.S.A. Panel Overlap = (0, 5, 5)"</span>,</span>
<span>       caption <span class="op">=</span> <span class="st">"spbal Halton Frame Overlapping Panel Design."</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span>
<span><span class="co">#&gt; Warning in st_point_on_surface.sfc(sf::st_zm(x)): st_point_on_surface may not</span></span>
<span><span class="co">#&gt; give correct results for longitude/latitude data</span></span></code></pre></div>
<p><img src="spbal_files/figure-html/HFex3a-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="halton-frame-stratified-sample-">Halton Frame Stratified sample.<a class="anchor" aria-label="anchor" href="#halton-frame-stratified-sample-"></a>
</h4>
<p>Stratified samples can be selected from a Halton Frame with
<strong>spbal</strong>. To implement this design, the input shapefile
must have labelled sub-regions or strata, which must be enclosed within
a single bounding box. We provide a stratified example design for <span class="math inline">\(50\)</span> sites are selected from three counties
in the state of North Carolina, U.S.A - Gates (<span class="math inline">\(n = 20\)</span>), Northampton (<span class="math inline">\(n = 30\)</span>), and Hertford (<span class="math inline">\(n = 10\)</span>).</p>
<p>Load the shape file for the Gates, Northampton and Hertford
regions.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gates"</span>, <span class="st">"Northampton"</span>, <span class="st">"Hertford"</span><span class="op">)</span></span>
<span><span class="va">n_strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gates"</span> <span class="op">=</span> <span class="fl">20</span>, <span class="st">"Northampton"</span> <span class="op">=</span> <span class="fl">30</span>, <span class="st">"Hertford"</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">shp_subset</span> <span class="op">&lt;-</span> <span class="va">shp_file</span><span class="op">[</span><span class="va">shp_file</span><span class="op">[[</span><span class="st">"NAME"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">strata</span>,<span class="op">]</span></span></code></pre></div>
<p>Define the bounding box for Gates, Northampton and Hertford using
<strong>spbal</strong>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bb_strata</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/BoundingBox.html">BoundingBox</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_subset</span><span class="op">)</span></span></code></pre></div>
<p>Generate an approximately regular <span class="math inline">\(B = 2^8
\times 3^5 = 256 \times 243\)</span> Halton Frame for the Gates,
Northampton and Hertford regions.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span></span>
<span><span class="va">result9</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/HaltonFrame.html">HaltonFrame</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_subset</span>,</span>
<span>                              N <span class="op">=</span> <span class="va">n_strata</span>,</span>
<span>                              J <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                              boundingbox <span class="op">=</span> <span class="va">bb_strata</span>,</span>
<span>                              stratum <span class="op">=</span> <span class="st">"NAME"</span><span class="op">)</span></span>
<span><span class="va">Frame</span> <span class="op">&lt;-</span> <span class="va">result9</span><span class="op">$</span><span class="va">hf.pts.shp</span></span></code></pre></div>
<p>Use the <strong>getSample()</strong> function to get <span class="math inline">\(10\)</span> points from the Hertford region.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">hertford_samp</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/getSample.html">getSample</a></span><span class="op">(</span><span class="va">Frame</span>, </span>
<span>                                  n <span class="op">=</span> <span class="va">n_samples</span>, </span>
<span>                                  strata <span class="op">=</span> <span class="st">"Hertford"</span>, </span>
<span>                                  stratum <span class="op">=</span> <span class="st">"NAME"</span><span class="op">)</span></span>
<span><span class="va">hertford_samp</span> <span class="op">&lt;-</span> <span class="va">hertford_samp</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">hertford_samp</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NAME"</span>, <span class="st">"spbalSeqID"</span>, <span class="st">"x"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; Simple feature collection with 10 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -77.16286 ymin: 36.23359 xmax: -76.78024 ymax: 36.55427</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt;         NAME spbalSeqID                          x</span></span>
<span><span class="co">#&gt; 14  Hertford          1 POINT (-77.06721 36.33691)</span></span>
<span><span class="co">#&gt; 31  Hertford          2 POINT (-77.13098 36.55427)</span></span>
<span><span class="co">#&gt; 4   Hertford          3 POINT (-76.87589 36.23359)</span></span>
<span><span class="co">#&gt; 51  Hertford          4 POINT (-77.00344 36.34227)</span></span>
<span><span class="co">#&gt; 7   Hertford          5 POINT (-77.16286 36.26982)</span></span>
<span><span class="co">#&gt; 82  Hertford          6  POINT (-76.90778 36.3785)</span></span>
<span><span class="co">#&gt; 92  Hertford          7 POINT (-77.03532 36.48718)</span></span>
<span><span class="co">#&gt; 101 Hertford          8 POINT (-76.78024 36.30605)</span></span>
<span><span class="co">#&gt; 111 Hertford          9 POINT (-77.09909 36.41473)</span></span>
<span><span class="co">#&gt; 13  Hertford         10 POINT (-76.97155 36.24567)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="panel-design-from-halton-frame">Panel Design from Halton Frame<a class="anchor" aria-label="anchor" href="#panel-design-from-halton-frame"></a>
</h4>
<p>Panel designs from Halton Frames are also possible in
<strong>spbal</strong>. The following call sets the last five elements
from panel <span class="math inline">\(1\)</span> as the first five
elements in panel <span class="math inline">\(2\)</span> and the last
five elements from panel <span class="math inline">\(2\)</span> as the
first five elements in panel <span class="math inline">\(3\)</span> (an
over-lapping design with <span class="math inline">\(50\)</span> unique
sites). Each panel is a spatially balanced sample of size <span class="math inline">\(n = 20\)</span>, and the collection of sites from
all panels is a spatially balanced sample of size <span class="math inline">\(n = 50\)</span>.</p>
<p>Generate an approximately regular <span class="math inline">\(B = 2^8
\times 3^5 = 256 \times 243\)</span> Halton Frame for Gates.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span></span>
<span><span class="va">panels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">n_panel_overlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">result10</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/HaltonFrame.html">HaltonFrame</a></span><span class="op">(</span>shapefile <span class="op">=</span> <span class="va">shp_gates</span>,</span>
<span>                               panels <span class="op">=</span> <span class="va">panels</span>,</span>
<span>                               panel_overlap <span class="op">=</span> <span class="va">n_panel_overlap</span>,</span>
<span>                               J <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>                               boundingbox <span class="op">=</span> <span class="va">bb</span><span class="op">)</span></span>
<span><span class="va">HaltonFramePanel</span> <span class="op">&lt;-</span> <span class="va">result10</span><span class="op">$</span><span class="va">hf.pts.shp</span></span></code></pre></div>
<p>Now we obtain the sites in panel <span class="math inline">\(1\)</span> using the <strong>getPanel()</strong>
function.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">panelid</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">SitesPanel_1</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/getPanel.html">getPanel</a></span><span class="op">(</span><span class="va">HaltonFramePanel</span>, <span class="va">panelid</span><span class="op">)</span></span>
<span><span class="va">SitesPanel_1</span> <span class="op">&lt;-</span> <span class="va">SitesPanel_1</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">SitesPanel_1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"spbalSeqID"</span>, <span class="st">"panel_id"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; Simple feature collection with 10 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -76.86985 ymin: 36.33583 xmax: -76.53069 ymax: 36.55364</span></span>
<span><span class="co">#&gt; Geodetic CRS:  NAD27</span></span>
<span><span class="co">#&gt;                             x spbalSeqID panel_id</span></span>
<span><span class="co">#&gt; 1  POINT (-76.80818 36.37982)          1        1</span></span>
<span><span class="co">#&gt; 2  POINT (-76.56152 36.46673)          2        1</span></span>
<span><span class="co">#&gt; 3  POINT (-76.86985 36.55364)          3        1</span></span>
<span><span class="co">#&gt; 5  POINT (-76.74652 36.38411)          4        1</span></span>
<span><span class="co">#&gt; 8  POINT (-76.65402 36.41308)          5        1</span></span>
<span><span class="co">#&gt; 9  POINT (-76.77735 36.49999)          6        1</span></span>
<span><span class="co">#&gt; 10 POINT (-76.53069 36.35514)          7        1</span></span>
<span><span class="co">#&gt; 11 POINT (-76.83901 36.44205)          8        1</span></span>
<span><span class="co">#&gt; 12 POINT (-76.59235 36.52896)          9        1</span></span>
<span><span class="co">#&gt; 16 POINT (-76.69256 36.33583)         10        1</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="halton-iterative-partitioning-hip">Halton Iterative Partitioning (HIP)<a class="anchor" aria-label="anchor" href="#halton-iterative-partitioning-hip"></a>
</h3>
<p>HIP draws spatially balanced samples and over-samples from point
resources by partitioning the resource into boxes with the same nested
structure as Halton boxes. The <strong>spbal</strong> parameter
<strong>iterations</strong> defines the number of boxes used in the HIP
partition and should be larger than the sample size but less than the
population size. The <strong>iterations parameter</strong> also defines
the number of units available in the HIP over-sample, where the
over-sample contains one unit from each box in the HIP partition.</p>
<p>Halton iterative partitioning (HIP) extends Basic acceptance sampling
(BAS) to point resources. It partitions the resource into <span class="math inline">\(B \geq n\)</span> boxes that have the same nested
structure as in BAS, but different sizes. These boxes are then uniquely
numbered using a random-start Halton sequence of length <span class="math inline">\(B\)</span>. The HIP sample is obtained by randomly
drawing one point from each of the boxes numbered <span class="math inline">\(1, 2, ..., n\)</span>.</p>
<p>HIP draws spatially balanced samples from point resources by
partitioning the resource into <span class="math inline">\(B = 2^{J_1} *
3^{J_2}\)</span> nested boxes.</p>
<div class="section level4">
<h4 id="spbalhip">spbal::HIP()<a class="anchor" aria-label="anchor" href="#spbalhip"></a>
</h4>
<p>The <strong>spbal::HIP()</strong> function supports the following
input parameters:</p>
<ul>
<li>
<strong>population</strong> A population of point pairs.</li>
<li>
<strong>n</strong> The number of points to draw from the population.
Default <span class="math inline">\(20\)</span>.</li>
<li>
<strong>iterations</strong> The levels of partitioning required.
Default <span class="math inline">\(7\)</span>.</li>
<li>
<strong>minRadius</strong> If specified, the minimum distance, in
meters, allowed between sample points. This is applied to the
<em>$overSample</em>.</li>
<li>
<strong>panels</strong> A list of integers that define the size of
each panel in a non-overlapping panels design. The length of the list
determines the number of panels required. The sum of the integers in the
panels parameter will determine the total number of samples selected,
<strong>n</strong>. The default value for <strong>panels</strong> is
NULL, this indicates that a non-overlapping panel design is not
wanted.</li>
<li>
<strong>panel_overlap</strong> A list of integers that define the
overlap into the previous panel. Is only used when the
<strong>panels</strong> parameter is not NULL. The default value for
<strong>panel_overlap</strong> is NULL. The length of
<strong>panel_overlap</strong> must be equal to the length of panels.
The first value is always forced to zero as the first panel never
overlaps any region.</li>
<li>
<strong>verbose</strong> A boolean, if you want to see any output
printed to screen set to TRUE. Helpful if taking a long time. The
default is FALSE i.e. no informational messages will be displayed.</li>
</ul>
<p>The <strong>HIP()</strong> function returns a list containing five
variables:</p>
<ul>
<li>
<strong>Population</strong> The original population.</li>
<li>
<strong>HaltonIndex</strong> The Halton index for the point. Points
will be spread equally across all Halton indices.</li>
<li>
<strong>sample</strong> The population sample.</li>
<li>
<strong>overSample</strong> The <em>overSample</em> contains one
point from each Halton box. All contiguous sub-samples from
<em>oversample</em> are spatially balanced, and the first <span class="math inline">\(n\)</span> points are identical to
<em>sample</em>.</li>
<li>
<strong>minRadius</strong> This result variable contains the sample
created using the <em>minRadius</em> parameter. If the
<em>minRadius</em> parameter is not specified then the
<em>minRadius</em> variable will contain NULL.</li>
</ul>
</div>
<div class="section level4">
<h4 id="spbalhip-code-example">spbal::HIP() code example<a class="anchor" aria-label="anchor" href="#spbalhip-code-example"></a>
</h4>
<p>The following sample code is used to demonstrate the use of the
<strong>spbal::HIP()</strong> function. Here we are generating <span class="math inline">\(20\)</span> points from a population of <span class="math inline">\(5,000\)</span> (random) points with <span class="math inline">\(7\)</span> levels of partitioning (<span class="math inline">\(4\)</span> in the first dimension and <span class="math inline">\(3\)</span> in the second) to give <span class="math inline">\(2^4\)</span> * <span class="math inline">\(3^3\)</span> = <span class="math inline">\(32 *
27\)</span>, resulting in <span class="math inline">\(864\)</span>
boxes.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set random seed</span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">511</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define HIP parameters.</span></span>
<span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">5000</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">5000</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">its</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span></span>
<span><span class="co"># Convert the population matrix to an sf point object.</span></span>
<span><span class="va">sf_points</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">sf_points</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5000    2</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># generate HIP sample.</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">spbal</span><span class="fu">::</span><span class="fu"><a href="../reference/HIP.html">HIP</a></span><span class="op">(</span>population <span class="op">=</span> <span class="va">sf_points</span>, </span>
<span>                     n <span class="op">=</span> <span class="va">n</span>, </span>
<span>                     iterations <span class="op">=</span>  <span class="va">its</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># HaltonIndex</span></span>
<span><span class="va">HaltonIndex</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">HaltonIndex</span></span>
<span><span class="co"># verify all spread equally, should be TRUE.</span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">HaltonIndex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Population Sample</span></span>
<span><span class="va">HIPsample</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="va">HIPsample</span></span>
<span><span class="co">#&gt; Simple feature collection with 20 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 0.04282557 ymin: 0.05113006 xmax: 0.9548381 ymax: 0.9662592</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    HaltonIndex spbalSeqID                     geometry</span></span>
<span><span class="co">#&gt; 1            0          1  POINT (0.9104533 0.1395789)</span></span>
<span><span class="co">#&gt; 2            1          2  POINT (0.2864811 0.6609214)</span></span>
<span><span class="co">#&gt; 3            2          3   POINT (0.590989 0.9033066)</span></span>
<span><span class="co">#&gt; 4            3          4  POINT (0.1926398 0.2614476)</span></span>
<span><span class="co">#&gt; 5            4          5  POINT (0.7768502 0.3905133)</span></span>
<span><span class="co">#&gt; 6            5          6  POINT (0.4038541 0.8324469)</span></span>
<span><span class="co">#&gt; 7            6          7 POINT (0.7109394 0.05113006)</span></span>
<span><span class="co">#&gt; 8            7          8 POINT (0.08206315 0.4703658)</span></span>
<span><span class="co">#&gt; 9            8          9  POINT (0.9548381 0.6773421)</span></span>
<span><span class="co">#&gt; 10           9         10  POINT (0.3318416 0.1603996)</span></span></code></pre></div>
<p>The HIP over-sample has <span class="math inline">\(432\)</span>
sites (one site from each of the <span class="math inline">\(432\)</span> boxes in the HIP partition).</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HIPoverSample</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">$</span><span class="va">overSample</span></span>
<span><span class="va">HIPoverSample</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geometry"</span>, <span class="st">"spbalSeqID"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; Simple feature collection with 10 features and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 0.08206315 ymin: 0.05113006 xmax: 0.9548381 ymax: 0.9033066</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt;                        geometry spbalSeqID</span></span>
<span><span class="co">#&gt; 1   POINT (0.9104533 0.1395789)          1</span></span>
<span><span class="co">#&gt; 2   POINT (0.2864811 0.6609214)          2</span></span>
<span><span class="co">#&gt; 3    POINT (0.590989 0.9033066)          3</span></span>
<span><span class="co">#&gt; 4   POINT (0.1926398 0.2614476)          4</span></span>
<span><span class="co">#&gt; 5   POINT (0.7768502 0.3905133)          5</span></span>
<span><span class="co">#&gt; 6   POINT (0.4038541 0.8324469)          6</span></span>
<span><span class="co">#&gt; 7  POINT (0.7109394 0.05113006)          7</span></span>
<span><span class="co">#&gt; 8  POINT (0.08206315 0.4703658)          8</span></span>
<span><span class="co">#&gt; 9   POINT (0.9548381 0.6773421)          9</span></span>
<span><span class="co">#&gt; 10  POINT (0.3318416 0.1603996)         10</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">OverSampleSize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">HIPoverSample</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">OverSampleSize</span></span>
<span><span class="co">#&gt; [1] 432</span></span></code></pre></div>
<p>The first <span class="math inline">\(n\)</span> points in
<strong>HIPoverSample</strong> are identical to
<strong>HIPsample</strong>.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compare the HIP sample and oversample, they will be the same.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">HIPsample</span><span class="op">$</span><span class="va">geometry</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span>, <span class="va">HIPoverSample</span><span class="op">$</span><span class="va">geometry</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="forcing-a-minimum-distance-between-sites">Forcing a minimum distance between sites<a class="anchor" aria-label="anchor" href="#forcing-a-minimum-distance-between-sites"></a>
</h4>
<p>HIP selects spatially balanced samples, but the algorithm can choose
sites closer together than desired, mainly if site density varies
significantly over the study region. To enforce a minimum distance
between sites, <strong>spbal</strong> has a minimum distance between
sites parameter <strong>minRadius</strong>. Setting
<strong>minRadius</strong> <span class="math inline">\(= r &gt;
0\)</span> draws an ordered subset <span class="math inline">\(S\)</span> from the HIP over-sample, where the
size of <span class="math inline">\(S\)</span> depends on the
<strong>iterations</strong> and <strong>minRadius</strong> parameters.
Taking the first <span class="math inline">\(n \leq |S|\)</span> sites
from <span class="math inline">\(S\)</span> gives a well-spread sample
of <span class="math inline">\(n\)</span> sites that satisfies the
minimum distance between sites requirement.</p>
</div>
<div class="section level4">
<h4 id="hip-panel-design">HIP Panel Design<a class="anchor" aria-label="anchor" href="#hip-panel-design"></a>
</h4>
<p>HIP Panel designs are also possible in <strong>spbal</strong>. Use
the <strong>panels</strong> and <strong>n_panel_overlap</strong>
parameters as demonstrated for the <strong>BAS</strong> and
<strong>HaltonFrame</strong> functions.</p>
</div>
</div>
<div class="section level3">
<h3 id="more-details">More Details<a class="anchor" aria-label="anchor" href="#more-details"></a>
</h3>
<p>The following section provides more details on the
<strong>spbal</strong> package functions <em>getSample</em> and
<em>getPanel</em>. These functions only accept objects created by
<strong>spbal</strong> as input via the <em>shapefile</em>
parameter.</p>
<div class="section level4">
<h4 id="getsample">
<em>getSample</em><a class="anchor" aria-label="anchor" href="#getsample"></a>
</h4>
<p>The <strong>spbal</strong> <em>getSample</em> function can be applied
to outputs produced by the <strong>spbal</strong> <em>BAS</em> and
<em>HaltonFrame</em> functions.</p>
<div class="section level5">
<h5 id="non-stratified-samples">Non-Stratified samples<a class="anchor" aria-label="anchor" href="#non-stratified-samples"></a>
</h5>
<p>Let ‘shp’ be the output from <em>BAS</em> or <em>HaltonFrame</em>,
then</p>
<ul>
<li>
<strong>getSample(shapefile = shp, n = n)</strong> will output the
first <span class="math inline">\(n\)</span> points from <span class="math inline">\(shp\)</span>.</li>
<li>
<strong>getSample(shapefile = shp, n = n, randomStart =
TRUE)</strong> will output <span class="math inline">\(n\)</span> points
(in the order of the frame) from a random starting point in <span class="math inline">\(shp\)</span>.</li>
</ul>
</div>
<div class="section level5">
<h5 id="stratified-samples">Stratified samples<a class="anchor" aria-label="anchor" href="#stratified-samples"></a>
</h5>
<p>In the case where the input is a stratified sample, both the <span class="math inline">\(strata\)</span> and <span class="math inline">\(stratum\)</span> parameters must be specified. If
they are specified then the <span class="math inline">\(n\)</span>
parameter need not be specified, if it is, it will be ignored. In this
case <em>getSample</em> will return all points of a stratified sample.
The parameter <span class="math inline">\(randomStart\)</span> is not
supported when dealing with stratified samples. If specified it will be
ignored.</p>
<ul>
<li>
<strong>getSample(shapefile = shp, strata = strata, stratum =
stratum)</strong> will output all points from <span class="math inline">\(shp\)</span> where the column name specified by
the <span class="math inline">\(stratum\)</span> parameter contains the
value specified by the <span class="math inline">\(strata\)</span>
parameter.</li>
</ul>
</div>
</div>
<div class="section level4">
<h4 id="getpanel">
<em>getPanel</em><a class="anchor" aria-label="anchor" href="#getpanel"></a>
</h4>
<p>The <strong>spbal</strong> <em>getPanel</em> function can be applied
to outputs produced by the <strong>spbal</strong> <em>BAS</em> and
<em>HaltonFrame</em> functions.</p>
<p>Let ‘shp’ be the output from <em>BAS</em> or <em>HaltonFrame</em>,
then</p>
<ul>
<li>
<strong>getPanel(shapefile = shp, panelid = panelid)</strong> will
output all the points belonging to panel <span class="math inline">\(panelid\)</span> from <span class="math inline">\(shp\)</span>.</li>
</ul>
<p>Use the <em>R</em> help function for more information on these
functions.</p>
</div>
</div>
<div class="section level3">
<h3 id="the-end">The End<a class="anchor" aria-label="anchor" href="#the-end"></a>
</h3>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Phil Davies, Blair Robertson, Paul van Dam-Bates, Oliver Gansell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
